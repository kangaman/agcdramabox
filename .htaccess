<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # 1. PAKSA HTTPS (Keamanan)
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # 2. HILANGKAN EKSTENSI .PHP
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}\.php -f
    RewriteRule ^(.*)$ $1.php [L]

    # 3. ROUTING URL CANTIK (Search, Nonton, Halaman Statis)
    RewriteRule ^cari/(.*)$ index.php?page=search&q=$1 [L,QSA]
    RewriteRule ^nonton/(.*)$ index.php?page=watch&id=$1 [L,QSA]
    RewriteRule ^terms$ index.php?page=terms [L,QSA]
    RewriteRule ^privacy$ index.php?page=privacy [L,QSA]
    RewriteRule ^login$ index.php?page=login [L,QSA]
    RewriteRule ^register$ index.php?page=register [L,QSA]
    RewriteRule ^logout$ index.php?page=logout [L,QSA]
    
    # Dashboard Routing
    RewriteRule ^dashboard$ index.php?page=dashboard/overview [L,QSA]
    RewriteRule ^dashboard/(.*)$ index.php?page=dashboard/$1 [L,QSA]

    # 4. BLOKIR AKSES KE FILE SENSITIF
    <FilesMatch "^\.">
        Order allow,deny
        Deny from all
    </FilesMatch>
    <FilesMatch "(config\.php|database\.php|composer\.json|README\.md)">
        Order allow,deny
        Deny from all
    </FilesMatch>
</IfModule>

# 5. KOMPRESI GZIP (Agar Website Ringan)
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# 6. BROWSER CACHING (Agar Loading Kedua Kali Instan)
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 year"
    ExpiresDefault "access plus 2 days"
</IfModule>